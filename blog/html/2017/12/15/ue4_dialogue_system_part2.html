<!DOCTYPE html><!--[if lt IE 7]>      <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>UE4 Dialogue System Part2 &mdash; Jinyu Liao&#39;s Blog</title>
    <link rel="stylesheet" href="../../../_static/normalize.css" type="text/css">
    <link rel="stylesheet" href="../../../_static/sphinx.css" type="text/css">
    <link rel="stylesheet" href="../../../_static/main.css" type="text/css">
        <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css">
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />

    
        <link rel="stylesheet" href="../../../_static/sphinxcontrib-images\LightBox2\lightbox2\css\lightbox.css" type="text/css" />
    

    
        <link rel="stylesheet" href="../../../_static/sphinxcontrib-images\LightBox2\lightbox2\css\lightbox.css" type="text/css" /><link rel="shortcut icon" href="../../../_static/tinkerer.ico" /><!-- Load modernizr and JQuery -->
        <script src="../../../_static/vendor/modernizr-2.6.2.min.js"></script>
        <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.8.2.min.js"></script>
        <script>window.jQuery || document.write('<script src="../../../_static/vendor/jquery-1.8.2.min.js"><\/script>')</script>
        <script src="../../../_static/plugins.js"></script>
        <script src="../../../_static/main.js"></script>
        <link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="UE4 Dialogue System Part1" href="ue4_dialogue_system_part1.html" /><link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.html" /><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script><script type="text/javascript" src="../../../_static/underscore.js"></script><script type="text/javascript" src="../../../_static/doctools.js"></script><script type="text/javascript" src="../../../_static/sphinxcontrib-images\LightBox2\lightbox2\js\lightbox.min.js"></script><script type="text/javascript" src="../../../_static/disqus.js"></script><script type="text/javascript" src="../../../_static/google_analytics.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            // Adjusts document height if sidebar is taller
            var documentwrapper = document.getElementsByTagName('article')[0];
            var sidebar = document.getElementsByTagName('aside')[0];

            if (sidebar.offsetHeight > documentwrapper.offsetHeight)
            {
                documentwrapper.style.minHeight = sidebar.offsetHeight + "px";
            }

            // Scroll to content if on small screen
            if (screen.width < 480)
            {
                $(document).scrollTop(documentwrapper.offsetTop - 44);
            }
        });
    </script></head>
    <body role="document">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      <div id="container"><div class="header-container">
    <header class="wrapper clearfix" role="banner">
        <div class="title">
          <h1><a href="../../../index.html">Jinyu Liao&#39;s Blog</a></h1>
          <h4></h4>
        </div>
        <nav role="navigation">
          <ul>
            <li class="main-nav">
              <a href="../../../index.html">Home</a>
            </li>
            <li class="main-nav">
              <a href="../../../pages/donate.html">Donate</a>
            </li>
            <li class="quicklink"><div class="rss">
        <a href="../../../rss.html" title="Subscribe via RSS"><span class="fa fa-lg fa-rss"></span></a>
    </div></li></ul>
        </nav>
    </header>
</div>

<div class="main-container" role="main"><div class="main wrapper body clearfix"><article>
        <!--<ul class="related clearfix">
            <li class="left"></li>
            <li class="right"><a href="ue4_dialogue_system_part1.html">UE4 Dialogue System Part1</a> &raquo; </li>
        </ul>-->
        <div class="wy-nav-content">
            <div class="rst-content">
                <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                        <div itemprop="articleBody">
                            <div class="timestamp postmeta">
            <span>December 15, 2017</span>
        </div>
    <div class="section" id="ue4-dialogue-system-part2">
<h1>UE4 Dialogue System Part2</h1>
<p><a class="reference external" href="https://jinyuliao.github.io/blog/html/2017/12/15/ue4_dialogue_system_part1.html">Part1</a></p>
<p>In this part, we will create a new asset type: <strong>DialogueSession</strong>.</p>
<div class="section" id="step-1">
<h2>Step 1</h2>
<ul class="simple">
<li>Create header files: “DialogueSession.h”, “DialogueSessionNode.h”, “DialogueSessionEdge.h” in your {ProjectRoot}/Source/{ProjectName}/Public folder</li>
<li>Create source files: “DialogueSession.cpp”, “DialogueSessionNode.cpp” in your {ProjectRoot}/Source/{ProjectName}/Private folder</li>
<li>Regenerate solution file</li>
<li>Open solution file</li>
</ul>
<p>now your solution should looks like this:</p>
<img alt="../../../_images/sln_with_dialogue_session.png" src="../../../_images/sln_with_dialogue_session.png" />
</div>
<div class="section" id="step-2">
<h2>Step 2</h2>
<p>Edit {YourProject}.Build.cs, add a dependency: <strong>GenericGraphRuntime</strong></p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="n">PrivateDependencyModuleNames</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;GenericGraphRuntime&quot;</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="step-3">
<h2>Step 3</h2>
<p>Implement class: UDialogueSessionNode</p>
<p>DialogueSessionNode.h</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;CoreMinimal.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;GenericGraphNode.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;DialogueSessionNode.generated.h&quot;</span><span class="cp"></span>

<span class="n">UENUM</span><span class="p">(</span><span class="n">BlueprintType</span><span class="p">)</span>
<span class="k">enum</span> <span class="k">class</span> <span class="nc">EDialoguerPostion</span> <span class="o">:</span> <span class="n">uint8</span>
<span class="p">{</span>
    <span class="n">Left</span><span class="p">,</span>
    <span class="n">Right</span>
<span class="p">};</span>

<span class="n">UCLASS</span><span class="p">(</span><span class="n">Blueprintable</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">UDialogueSessionNode</span> <span class="o">:</span> <span class="k">public</span> <span class="n">UGenericGraphNode</span>
<span class="p">{</span>
    <span class="n">GENERATED_BODY</span><span class="p">()</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">UDialogueSessionNode</span><span class="p">();</span>

    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">BlueprintReadOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">&quot;DialogueSession&quot;</span><span class="p">)</span>
    <span class="n">FText</span> <span class="n">Paragraph</span><span class="p">;</span>

    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">BlueprintReadOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">&quot;DialogueSession&quot;</span><span class="p">)</span>
    <span class="n">EDialoguerPostion</span> <span class="n">DialoguerPostion</span><span class="p">;</span>

<span class="cp">#if WITH_EDITOR</span>
    <span class="k">virtual</span> <span class="n">FText</span> <span class="nf">GetNodeTitle</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span><span class="p">;</span>

    <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">SetNodeTitle</span><span class="p">(</span><span class="k">const</span> <span class="n">FText</span><span class="o">&amp;</span> <span class="n">NewTitle</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>

    <span class="k">virtual</span> <span class="n">FLinearColor</span> <span class="nf">GetBackgroundColor</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">};</span>
</pre></div>
</div>
<p>DialogueSessionNode.cpp</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;DialogueSessionNode.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;DialogueSession.h&quot;</span><span class="cp"></span>

<span class="cp">#define LOCTEXT_NAMESPACE &quot;DialogueSessionNode&quot;</span>

<span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">UDialogueSessionNode</span><span class="p">()</span>
<span class="p">{</span>
<span class="cp">#if WITH_EDITORONLY_DATA</span>
    <span class="n">CompatibleGraphType</span> <span class="o">=</span> <span class="n">UDialogueSession</span><span class="o">::</span><span class="n">StaticClass</span><span class="p">();</span>

    <span class="n">ContextMenuName</span> <span class="o">=</span> <span class="n">LOCTEXT</span><span class="p">(</span><span class="s">&quot;ConextMenuName&quot;</span><span class="p">,</span> <span class="s">&quot;Dialogue Session Node&quot;</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="cp">#if WITH_EDITOR</span>

<span class="n">FText</span> <span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">GetNodeTitle</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">Paragraph</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">()</span> <span class="o">?</span> <span class="n">LOCTEXT</span><span class="p">(</span><span class="s">&quot;EmptyParagraph&quot;</span><span class="p">,</span> <span class="s">&quot;(Empty paragraph)&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="n">Paragraph</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">SetNodeTitle</span><span class="p">(</span><span class="k">const</span> <span class="n">FText</span><span class="o">&amp;</span> <span class="n">NewTitle</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Paragraph</span> <span class="o">=</span> <span class="n">NewTitle</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">FLinearColor</span> <span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">GetBackgroundColor</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="n">UDialogueSession</span><span class="o">*</span> <span class="n">Graph</span> <span class="o">=</span> <span class="n">Cast</span><span class="o">&lt;</span><span class="n">UDialogueSession</span><span class="o">&gt;</span><span class="p">(</span><span class="n">GetGraph</span><span class="p">());</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">Graph</span> <span class="o">==</span> <span class="k">nullptr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Super</span><span class="o">::</span><span class="n">GetBackgroundColor</span><span class="p">();</span>

    <span class="k">switch</span> <span class="p">(</span><span class="n">DialoguerPostion</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <span class="n">EDialoguerPostion</span><span class="o">::</span><span class="nl">Left</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="o">-&gt;</span><span class="n">LeftDialoguerBgColor</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">EDialoguerPostion</span><span class="o">::</span><span class="nl">Right</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="o">-&gt;</span><span class="n">RightDialoguerBgColor</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">FLinearColor</span><span class="o">::</span><span class="n">Black</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cp">#endif</span>

<span class="cp">#undef LOCTEXT_NAMESPACE</span>
</pre></div>
</div>
<p>We extended the <em>UGenericGraphNode</em>, added two properties to the node:</p>
<ul class="simple">
<li><em>Paragraph</em>: the dialogue content</li>
<li><em>DialoguerPostion</em>: indicate the dialoguer’s position(left or right).</li>
</ul>
<p>Override the <em>GetNodeTitle</em> and <em>SetNodeTitle</em> method to use the Paragraph property as the node title.</p>
<p>Override the <em>GetBackgroundColor</em> method, change the node’s background color by dialoguer’s position</p>
</div>
<div class="section" id="step-4">
<h2>Step 4</h2>
<p>Implement class: UDialogueSessionEdge</p>
<p>DialogueSessionEdge.h</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;CoreMinimal.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;GenericGraphEdge.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;DialogueSessionEdge.generated.h&quot;</span><span class="cp"></span>


<span class="n">UCLASS</span><span class="p">(</span><span class="n">Blueprintable</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">UDialogueSessionEdge</span><span class="o">:</span> <span class="k">public</span> <span class="n">UGenericGraphEdge</span>
<span class="p">{</span>
    <span class="n">GENERATED_BODY</span><span class="p">()</span>

<span class="k">public</span><span class="o">:</span>
    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">BlueprintReadOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">&quot;DialogueSession&quot;</span><span class="p">)</span>
    <span class="n">FText</span> <span class="n">Selection</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>We extended the <em>UDialogueSessionEdge</em>, added a <em>Selection</em> property, this will be used to implment dialogue branch.</p>
</div>
<div class="section" id="step-5">
<h2>Step 5</h2>
<p>Implement class: UDialogueSession</p>
<p>DialogueSession.h:</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;CoreMinimal.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;GenericGraph.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;DialogueSession.generated.h&quot;</span><span class="cp"></span>

<span class="n">UCLASS</span><span class="p">(</span><span class="n">Blueprintable</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">DIALOGUESYSTEM_API</span> <span class="nl">UDialogueSession</span><span class="p">:</span> <span class="k">public</span> <span class="n">UGenericGraph</span>
<span class="p">{</span>
    <span class="n">GENERATED_BODY</span><span class="p">()</span>

<span class="k">public</span><span class="o">:</span>
    <span class="n">UDialogueSession</span><span class="p">();</span>

    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">&quot;DialogueSession&quot;</span><span class="p">)</span>
    <span class="n">FLinearColor</span> <span class="n">LeftDialoguerBgColor</span><span class="p">;</span>

    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">&quot;DialogueSession&quot;</span><span class="p">)</span>
    <span class="n">FLinearColor</span> <span class="n">RightDialoguerBgColor</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>DialogueSession.cpp</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;DialogueSession.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;DialogueSessionNode.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;DialogueSessionEdge.h&quot;</span><span class="cp"></span>

<span class="cp">#define LOCTEXT_NAMESPACE &quot;DialogueSession&quot;</span>

<span class="n">UDialogueSession</span><span class="o">::</span><span class="n">UDialogueSession</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">NodeType</span> <span class="o">=</span> <span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">StaticClass</span><span class="p">();</span>
    <span class="n">EdgeType</span> <span class="o">=</span> <span class="n">UDialogueSessionEdge</span><span class="o">::</span><span class="n">StaticClass</span><span class="p">();</span>

    <span class="n">LeftDialoguerBgColor</span> <span class="o">=</span> <span class="n">FLinearColor</span><span class="o">::</span><span class="n">Black</span><span class="p">;</span>
    <span class="n">RightDialoguerBgColor</span> <span class="o">=</span> <span class="n">FLinearColor</span><span class="p">(</span><span class="mf">0.93f</span><span class="p">,</span> <span class="mf">0.93f</span><span class="p">,</span> <span class="mf">0.93f</span><span class="p">,</span> <span class="mf">1.f</span><span class="p">);</span>

    <span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;DialogueSession&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#undef LOCTEXT_NAMESPACE</span>
</pre></div>
</div>
<p>We created a class <em>UDialogueSession</em> which inherit from <em>UGenericGraph</em>, this class will be the new asset type.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">DIALOGUESYSTEM_API should changed to {YOURPROJECT}_API.</p>
</div>
</div>
<div class="section" id="step-6">
<h2>Step 6</h2>
<p>We need to create an asset factory which inherit from <em>UFactory</em>, but this class can’t add to your game project directly, because <em>UFactory</em> are in the module <strong>UnrealEd</strong>, this is an editor module,
you can’t pass the Shipping build if your game depends on any editor module.</p>
<p>Solution: creating an editor module for your game project, here is an <a class="reference external" href="https://wiki.unrealengine.com/Creating_an_Editor_Module">tutorial</a>.</p>
<p>After created an editor module, creating “DialogueSessionFactory.h” and “DialogueSessionFactory.cpp” in {YourProject}/Source/{YourProjectEditor}/Private and regenerate solution file.</p>
<p>Your solution should looks like this now:</p>
<img alt="../../../_images/sln_with_editor.png" src="../../../_images/sln_with_editor.png" />
</div>
<div class="section" id="step-7">
<h2>Step 7</h2>
<p>Edit the {YourProjectEditor}.Build.cs, add dependency module: <em>UnrealEd</em>, <em>GenericGraphRuntime</em>, <em>{YourGameProject}</em> and include path: <em>{YourGameProject}/Public</em></p>
<div class="highlight-c#"><div class="highlight"><pre><span></span><span class="n">PublicIncludePaths</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="k">new</span> <span class="kt">string</span><span class="p">[]{</span><span class="s">&quot;DialogueSystem/Public&quot;</span><span class="p">});</span>

<span class="n">PrivateDependencyModuleNames</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">&quot;UnrealEd&quot;</span><span class="p">,</span> <span class="s">&quot;GenericGraphRuntime&quot;</span><span class="p">,</span> <span class="s">&quot;DialogueSystem&quot;</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="step-8">
<h2>Step 8</h2>
<p>Implement DialogueSessionFactory</p>
<p>DialogueSessionFactory.h</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">&quot;CoreMinimal.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;Factories/Factory.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;DialogueSessionFactory.generated.h&quot;</span><span class="cp"></span>

<span class="n">UCLASS</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">UDialogueSessionFactory</span> <span class="o">:</span> <span class="k">public</span> <span class="n">UFactory</span>
<span class="p">{</span>
    <span class="n">GENERATED_BODY</span><span class="p">()</span>

<span class="k">public</span><span class="o">:</span>
    <span class="n">UDialogueSessionFactory</span><span class="p">();</span>

    <span class="k">virtual</span> <span class="n">UObject</span><span class="o">*</span> <span class="nf">FactoryCreateNew</span><span class="p">(</span><span class="n">UClass</span><span class="o">*</span> <span class="n">Class</span><span class="p">,</span> <span class="n">UObject</span><span class="o">*</span> <span class="n">InParent</span><span class="p">,</span> <span class="n">FName</span> <span class="n">Name</span><span class="p">,</span> <span class="n">EObjectFlags</span> <span class="n">Flags</span><span class="p">,</span> <span class="n">UObject</span><span class="o">*</span> <span class="n">Context</span><span class="p">,</span> <span class="n">FFeedbackContext</span><span class="o">*</span> <span class="n">Warn</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="n">FText</span> <span class="nf">GetDisplayName</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="n">FString</span> <span class="nf">GetDefaultNewAssetName</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>DialogueSessionFactory.cpp</p>
<div class="highlight-c++"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;DialogueSessionFactory.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;DialogueSession.h&quot;</span><span class="cp"></span>

<span class="cp">#define LOCTEXT_NAMESPACE &quot;DialogueSessionFactory&quot;</span>

<span class="n">UDialogueSessionFactory</span><span class="o">::</span><span class="n">UDialogueSessionFactory</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">bCreateNew</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">bEditAfterNew</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">SupportedClass</span> <span class="o">=</span> <span class="n">UDialogueSession</span><span class="o">::</span><span class="n">StaticClass</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">UObject</span><span class="o">*</span> <span class="n">UDialogueSessionFactory</span><span class="o">::</span><span class="n">FactoryCreateNew</span><span class="p">(</span><span class="n">UClass</span><span class="o">*</span> <span class="n">Class</span><span class="p">,</span> <span class="n">UObject</span><span class="o">*</span> <span class="n">InParent</span><span class="p">,</span> <span class="n">FName</span> <span class="n">Name</span><span class="p">,</span> <span class="n">EObjectFlags</span> <span class="n">Flags</span><span class="p">,</span> <span class="n">UObject</span><span class="o">*</span> <span class="n">Context</span><span class="p">,</span> <span class="n">FFeedbackContext</span><span class="o">*</span> <span class="n">Warn</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">NewObject</span><span class="o">&lt;</span><span class="n">UObject</span><span class="o">&gt;</span><span class="p">(</span><span class="n">InParent</span><span class="p">,</span> <span class="n">Class</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Flags</span> <span class="o">|</span> <span class="n">RF_Transactional</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">FText</span> <span class="n">UDialogueSessionFactory</span><span class="o">::</span><span class="n">GetDisplayName</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">LOCTEXT</span><span class="p">(</span><span class="s">&quot;FactoryName&quot;</span><span class="p">,</span> <span class="s">&quot;Dialogue Session&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">FString</span> <span class="n">UDialogueSessionFactory</span><span class="o">::</span><span class="n">GetDefaultNewAssetName</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="s">&quot;DialogueSession&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#undef LOCTEXT_NAMESPACE</span>
</pre></div>
</div>
</div>
<div class="section" id="step-9">
<h2>Step 9</h2>
<p>Compile the solution, open the editor if compile succeeded. right click in your content browser, you can create DialogueSession asset now.</p>
<a class=""
               data-lightbox="group-31b4a8c6-b75a-4327-a93d-8c81d636ed8f"
               href="../../../_images/dialogue_session_asset1.png"
               title=""
               data-title=""
               ><img src="../../../_images/dialogue_session_asset1.png"
                     class=""
                     width="100%"
                     height="auto"
                     alt=""/>
                </a></div>
<div class="section" id="done">
<h2>Done</h2>
<p>That’s all in this part, you have created a new asset type <a class="footnote-reference" href="#f1" id="id1">[1]</a> <strong>DialogueSession</strong> and extended GenericGraph’s node and edge type.</p>
<p>In the next part, we will dive into blueprint :)</p>
<table class="docutils footnote" frame="void" id="f1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>a new graph type with GenericGraph editor</td></tr>
</tbody>
</table>
</div>
</div>

    <div class="postmeta">
        <div class="author">
            <span>Posted by Jinyu Liao</span>
        </div>
        <div class="categories">
            <span>
                Filed under:
                <a href="../../../categories/ue4_dialogue_system.html">UE4 Dialogue System</a></span>
        </div>
        <div class="tags">
            <span>
                Tags:
                <a href="../../../tags/ue4.html">UE4</a>, <a href="../../../tags/tutorial.html">Tutorial</a></span>
        </div>
        </div>
    <div id="disqus_thread"></div><script type="text/javascript">    var disqus_shortname = "jinyuliao";    var disqus_identifier = "2017/12/15/ue4_dialogue_system_part2";    disqus_thread();</script><noscript>Please enable JavaScript to view the    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                        </div>
                        <div class="articleComments">
                            
                        </div>
                    </div>
                    <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Jinyu Liao.
    
    <div class="column-logo">
        <ul class="social">
            <li><a href="https://github.com/jinyuliao" rel="noopener noreferrer"><span class="icon github"></span></a></li>
            <li><a href="https://twitter.com/jinyuliao" rel="noopener noreferrer"><span class="icon twitter"></span></a></li>
        </ul>
    </div>
    </p>
  </div>
</footer>

                </div>
            </div>
            <!--<ul class="related clearfix">
            <li class="left"></li>
            <li class="right"><a href="ue4_dialogue_system_part1.html">UE4 Dialogue System Part1</a> &raquo; </li>
        </ul>--></article><aside class="sidebar"><section><div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div></section><section><div class="widget">
    <h3>Recent Posts</h3>
    <ul><li>
            <a href="#">UE4 Dialogue System Part2</a>
        </li><li>
            <a href="ue4_dialogue_system_part1.html">UE4 Dialogue System Part1</a>
        </li><li>
            <a href="../../11/23/srpg_tutorial_pt1_cn.html">使用UE4制作SRPG Part1</a>
        </li></ul>
</div>
</section><section><div class="widget">
    <h3>Categories</h3>
    <ul><li><a href="../../../categories/ue4_dialogue_system.html">UE4 Dialogue System</a> (2)</li><li><a href="../../../categories/ue4_srpg.html">UE4 SRPG</a> (1)</li></ul>
</div></section><section><div class="widget">
    <h3>Tags</h3><a href="../../../tags/tutorial.html">Tutorial</a> (2), <a href="../../../tags/ue4.html">UE4</a> (3), <a href="../../../tags/教程.html">教程</a> (1)</div></section></aside></div> <!-- #main --></div> <!-- #main-container -->

        <div class="footer-container" role="contentinfo">
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
			$(this).parent().children().not(".header").slideToggle(200);
            //$(this).parent().children().not(".header").toggle(200);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>
</div> <!-- footer-container -->

      </div> <!--! end of #container --><!--[if lt IE 7 ]>
          <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
          <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
        <![endif]-->
    </body>
</html>