<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>Jinyu Liao's Blog</title>
        <link>https://jinyuliao.github.io/blog/html/</link>
        <description></description>
        <language>en-us</language>
        <pubDate>Tue, 20 Mar 2018 00:00:00 +0800</pubDate>
        
        <item>
            <link>https://jinyuliao.github.io/blog/html/2018/03/20/ue4_dialogue_system_part3.html</link>
            <guid>https://jinyuliao.github.io/blog/html/2018/03/20/ue4_dialogue_system_part3.html</guid>
            <title><![CDATA[UE4 Dialogue System Part3]]></title>
            <description><![CDATA[<h1>UE4 Dialogue System Part3</h1>
<p><a class="reference external" href="https://jinyuliao.github.io/blog/html/2017/12/15/ue4_dialogue_system_part2.html">Part2</a></p>
<p><strong>Tutorial Project</strong>: <a class="reference external" href="https://github.com/jinyuliao/Tutorial_DialogueSystem">Tutorial_DialogueSystem</a></p>
<p>In this part, we will create a dialogue widget which use DialogueSession asset as input to display dialogue on screen.</p>
<a class="" data-lightbox="group-f9e7e58c-a452-4278-a185-28230e3ad612" href="https://jinyuliao.github.io/blog/html/_images/dialogue_session_to_screen1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/dialogue_session_to_screen1.png" class="" width="100%" height="auto" alt=""/>
                </a><div class="section" id="step-1">
<h2>Step 1</h2>
<p>Create an UMG widget: UI_Dialogue, like this:</p>
<a class="" data-lightbox="group-1bfd344a-f72b-49ef-8b22-5f9eaf2360e9" href="https://jinyuliao.github.io/blog/html/_images/dialogue_widget_layout1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/dialogue_widget_layout1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="step-2">
<h2>Step 2</h2>
<p>Create function: <em>StartSession</em> and <em>Next</em>.</p>
<p>StartSession’s function signature:</p>
<img alt="../../../_images/start_session_sign.png" src="https://jinyuliao.github.io/blog/html/_images/start_session_sign.png"/>
<p>Next’s function signature:</p>
<img alt="../../../_images/next_sign.png" src="https://jinyuliao.github.io/blog/html/_images/next_sign.png"/>
<p>Create some variables:</p>
<ul class="simple">
<li>CurrentSession: DialogueSession(type)</li>
<li>CurrentDialogueNode: DialogueSessionNode(type)</li>
<li>NodeIndex: Integer(type)</li>
</ul>
<p>bind MainText’s <em>Text</em> field to CurrentDialogueNode’s <em>Paragraph</em> property, like this:</p>
<a class="" data-lightbox="group-9eff9c91-c73c-45e0-a435-ff3f8b4cee88" href="https://jinyuliao.github.io/blog/html/_images/dialogue_main_text_bind1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/dialogue_main_text_bind1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="step-3">
<h2>Step 3</h2>
<p>Implement function: <em>StartSession</em></p>
<a class="" data-lightbox="group-e5ae6deb-2b97-4e3d-951c-5815590e8811" href="https://jinyuliao.github.io/blog/html/_images/start_session_impl1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/start_session_impl1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="step-4">
<h2>Step 4</h2>
<p>Implement function: <em>Next</em></p>
<a class="" data-lightbox="group-19e7d1a3-0f4e-4b67-b991-1824a8d4b38a" href="https://jinyuliao.github.io/blog/html/_images/next_impl1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/next_impl1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="step-5">
<h2>Step 5</h2>
<p>Create a DialogueSession asset: Dialogue_Test</p>
<img alt="../../../_images/test_dialogue_session.png" src="https://jinyuliao.github.io/blog/html/_images/test_dialogue_session.png"/>
</div>
<div class="section" id="step-6">
<h2>Step 6</h2>
<p>Create a UMG widget: UI_HUD, layout it like this:</p>
<a class="" data-lightbox="group-0508d706-8b1c-49b6-9549-07de5e7a6f28" href="https://jinyuliao.github.io/blog/html/_images/hud_layout1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/hud_layout1.png" class="" width="100%" height="auto" alt=""/>
                </a><p>create a bind for UI_Dialogue’s <em>Visibility</em>:</p>
<a class="" data-lightbox="group-264a7d28-14a3-419b-b9f7-10296875ced8" href="https://jinyuliao.github.io/blog/html/_images/dialogue_visibility_bind1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/dialogue_visibility_bind1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="step-7">
<h2>Step 7</h2>
<p>Setup input action mapping: <em>Next</em></p>
<a class="" data-lightbox="group-0e6e193e-470a-4ed6-9a16-28ca51944ff4" href="https://jinyuliao.github.io/blog/html/_images/next_input1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/next_input1.png" class="" width="100%" height="auto" alt=""/>
                </a><p>create an UI_HUD widget, add it to viewport and setup for <em>Next</em> event:</p>
<a class="" data-lightbox="group-08b53c2b-4d7c-4fcb-b6ac-3c49d61109fd" href="https://jinyuliao.github.io/blog/html/_images/controller_setup1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/controller_setup1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="step-8">
<h2>Step 8</h2>
<p>Add a test trigger into your test map</p>
<a class="" data-lightbox="group-57f228a1-ba98-431d-93b9-4566a85135a8" href="https://jinyuliao.github.io/blog/html/_images/test_trigger1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/test_trigger1.png" class="" width="100%" height="auto" alt=""/>
                </a><p>open <strong>Level Blueprint</strong>, setup BeginOverlap event like this:</p>
<a class="" data-lightbox="group-62edcee9-4fe0-4ac9-a3a9-4ea5e3bdac35" href="https://jinyuliao.github.io/blog/html/_images/test_trigger_overlap1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/test_trigger_overlap1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="step-9">
<h2>Step 9</h2>
<p>Play. move character to the position of test trigger, now you can see the dialogue widget. press <strong>N</strong> goto the next paragraph.</p>
</div>
<div class="section" id="done">
<h2>Done</h2>
<p>That’s all in this part. In the next part, we wiil support dialoguer information such as: name, portrait image.</p>
</div>
]]></description>
            <category><![CDATA[ UE4 Dialogue System ]]></category>
             <pubDate>Tue, 20 Mar 2018 00:00:00 +0800</pubDate>
        </item>
    
        <item>
            <link>https://jinyuliao.github.io/blog/html/2017/12/15/ue4_dialogue_system_part2.html</link>
            <guid>https://jinyuliao.github.io/blog/html/2017/12/15/ue4_dialogue_system_part2.html</guid>
            <title><![CDATA[UE4 Dialogue System Part2]]></title>
            <description><![CDATA[<h1>UE4 Dialogue System Part2</h1>
<p><a class="reference external" href="https://jinyuliao.github.io/blog/html/2017/12/15/ue4_dialogue_system_part1.html">Part1</a></p>
<p>In this part, we will create a new asset type: <strong>DialogueSession</strong>.</p>
<div class="section" id="step-1">
<h2>Step 1</h2>
<ul class="simple">
<li>Create header files: “DialogueSession.h”, “DialogueSessionNode.h”, “DialogueSessionEdge.h” in your {ProjectRoot}/Source/{ProjectName}/Public folder</li>
<li>Create source files: “DialogueSession.cpp”, “DialogueSessionNode.cpp” in your {ProjectRoot}/Source/{ProjectName}/Private folder</li>
<li>Regenerate solution file</li>
<li>Open solution file</li>
</ul>
<p>now your solution should looks like this:</p>
<img alt="../../../_images/sln_with_dialogue_session.png" src="https://jinyuliao.github.io/blog/html/_images/sln_with_dialogue_session.png"/>
</div>
<div class="section" id="step-2">
<h2>Step 2</h2>
<p>Edit {YourProject}.Build.cs, add a dependency: <strong>GenericGraphRuntime</strong></p>
<div class="highlight-c#"><div class="highlight"><pre><span/><span class="n">PrivateDependencyModuleNames</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"GenericGraphRuntime"</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="step-3">
<h2>Step 3</h2>
<p>Implement class: UDialogueSessionNode</p>
<p>DialogueSessionNode.h</p>
<div class="highlight-c++"><div class="highlight"><pre><span/><span class="cp">#pragma once</span>

<span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">"CoreMinimal.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"GenericGraphNode.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"DialogueSessionNode.generated.h"</span><span class="cp"/>

<span class="n">UENUM</span><span class="p">(</span><span class="n">BlueprintType</span><span class="p">)</span>
<span class="k">enum</span> <span class="k">class</span> <span class="nc">EDialoguerPostion</span> <span class="o">:</span> <span class="n">uint8</span>
<span class="p">{</span>
    <span class="n">Left</span><span class="p">,</span>
    <span class="n">Right</span>
<span class="p">};</span>

<span class="n">UCLASS</span><span class="p">(</span><span class="n">Blueprintable</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">UDialogueSessionNode</span> <span class="o">:</span> <span class="k">public</span> <span class="n">UGenericGraphNode</span>
<span class="p">{</span>
    <span class="n">GENERATED_BODY</span><span class="p">()</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">UDialogueSessionNode</span><span class="p">();</span>

    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">BlueprintReadOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">"DialogueSession"</span><span class="p">)</span>
    <span class="n">FText</span> <span class="n">Paragraph</span><span class="p">;</span>

    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">BlueprintReadOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">"DialogueSession"</span><span class="p">)</span>
    <span class="n">EDialoguerPostion</span> <span class="n">DialoguerPostion</span><span class="p">;</span>

<span class="cp">#if WITH_EDITOR</span>
    <span class="k">virtual</span> <span class="n">FText</span> <span class="nf">GetNodeTitle</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span><span class="p">;</span>

    <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">SetNodeTitle</span><span class="p">(</span><span class="k">const</span> <span class="n">FText</span><span class="o">&amp;</span> <span class="n">NewTitle</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>

    <span class="k">virtual</span> <span class="n">FLinearColor</span> <span class="nf">GetBackgroundColor</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">};</span>
</pre></div>
</div>
<p>DialogueSessionNode.cpp</p>
<div class="highlight-c++"><div class="highlight"><pre><span/><span class="cp">#include</span> <span class="cpf">"DialogueSessionNode.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"DialogueSession.h"</span><span class="cp"/>

<span class="cp">#define LOCTEXT_NAMESPACE "DialogueSessionNode"</span>

<span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">UDialogueSessionNode</span><span class="p">()</span>
<span class="p">{</span>
<span class="cp">#if WITH_EDITORONLY_DATA</span>
    <span class="n">CompatibleGraphType</span> <span class="o">=</span> <span class="n">UDialogueSession</span><span class="o">::</span><span class="n">StaticClass</span><span class="p">();</span>

    <span class="n">ContextMenuName</span> <span class="o">=</span> <span class="n">LOCTEXT</span><span class="p">(</span><span class="s">"ConextMenuName"</span><span class="p">,</span> <span class="s">"Dialogue Session Node"</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="cp">#if WITH_EDITOR</span>

<span class="n">FText</span> <span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">GetNodeTitle</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">Paragraph</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">()</span> <span class="o">?</span> <span class="n">LOCTEXT</span><span class="p">(</span><span class="s">"EmptyParagraph"</span><span class="p">,</span> <span class="s">"(Empty paragraph)"</span><span class="p">)</span> <span class="o">:</span> <span class="n">Paragraph</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">SetNodeTitle</span><span class="p">(</span><span class="k">const</span> <span class="n">FText</span><span class="o">&amp;</span> <span class="n">NewTitle</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Paragraph</span> <span class="o">=</span> <span class="n">NewTitle</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">FLinearColor</span> <span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">GetBackgroundColor</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="n">UDialogueSession</span><span class="o">*</span> <span class="n">Graph</span> <span class="o">=</span> <span class="n">Cast</span><span class="o">&lt;</span><span class="n">UDialogueSession</span><span class="o">&gt;</span><span class="p">(</span><span class="n">GetGraph</span><span class="p">());</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">Graph</span> <span class="o">==</span> <span class="k">nullptr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Super</span><span class="o">::</span><span class="n">GetBackgroundColor</span><span class="p">();</span>

    <span class="k">switch</span> <span class="p">(</span><span class="n">DialoguerPostion</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <span class="n">EDialoguerPostion</span><span class="o">::</span><span class="nl">Left</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="o">-&gt;</span><span class="n">LeftDialoguerBgColor</span><span class="p">;</span>
    <span class="k">case</span> <span class="n">EDialoguerPostion</span><span class="o">::</span><span class="nl">Right</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Graph</span><span class="o">-&gt;</span><span class="n">RightDialoguerBgColor</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">FLinearColor</span><span class="o">::</span><span class="n">Black</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cp">#endif</span>

<span class="cp">#undef LOCTEXT_NAMESPACE</span>
</pre></div>
</div>
<p>We extended the <em>UGenericGraphNode</em>, added two properties to the node:</p>
<ul class="simple">
<li><em>Paragraph</em>: the dialogue content</li>
<li><em>DialoguerPostion</em>: indicate the dialoguer’s position(left or right).</li>
</ul>
<p>Override the <em>GetNodeTitle</em> and <em>SetNodeTitle</em> method to use the Paragraph property as the node title.</p>
<p>Override the <em>GetBackgroundColor</em> method, change the node’s background color by dialoguer’s position</p>
</div>
<div class="section" id="step-4">
<h2>Step 4</h2>
<p>Implement class: UDialogueSessionEdge</p>
<p>DialogueSessionEdge.h</p>
<div class="highlight-c++"><div class="highlight"><pre><span/><span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">"CoreMinimal.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"GenericGraphEdge.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"DialogueSessionEdge.generated.h"</span><span class="cp"/>


<span class="n">UCLASS</span><span class="p">(</span><span class="n">Blueprintable</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">UDialogueSessionEdge</span><span class="o">:</span> <span class="k">public</span> <span class="n">UGenericGraphEdge</span>
<span class="p">{</span>
    <span class="n">GENERATED_BODY</span><span class="p">()</span>

<span class="k">public</span><span class="o">:</span>
    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">BlueprintReadOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">"DialogueSession"</span><span class="p">)</span>
    <span class="n">FText</span> <span class="n">Selection</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>We extended the <em>UDialogueSessionEdge</em>, added a <em>Selection</em> property, this will be used to implment dialogue branch.</p>
</div>
<div class="section" id="step-5">
<h2>Step 5</h2>
<p>Implement class: UDialogueSession</p>
<p>DialogueSession.h:</p>
<div class="highlight-c++"><div class="highlight"><pre><span/><span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">"CoreMinimal.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"GenericGraph.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"DialogueSession.generated.h"</span><span class="cp"/>

<span class="n">UCLASS</span><span class="p">(</span><span class="n">Blueprintable</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">DIALOGUESYSTEM_API</span> <span class="nl">UDialogueSession</span><span class="p">:</span> <span class="k">public</span> <span class="n">UGenericGraph</span>
<span class="p">{</span>
    <span class="n">GENERATED_BODY</span><span class="p">()</span>

<span class="k">public</span><span class="o">:</span>
    <span class="n">UDialogueSession</span><span class="p">();</span>

    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">"DialogueSession"</span><span class="p">)</span>
    <span class="n">FLinearColor</span> <span class="n">LeftDialoguerBgColor</span><span class="p">;</span>

    <span class="n">UPROPERTY</span><span class="p">(</span><span class="n">EditDefaultsOnly</span><span class="p">,</span> <span class="n">Category</span> <span class="o">=</span> <span class="s">"DialogueSession"</span><span class="p">)</span>
    <span class="n">FLinearColor</span> <span class="n">RightDialoguerBgColor</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>DialogueSession.cpp</p>
<div class="highlight-c++"><div class="highlight"><pre><span/><span class="cp">#include</span> <span class="cpf">"DialogueSession.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"DialogueSessionNode.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"DialogueSessionEdge.h"</span><span class="cp"/>

<span class="cp">#define LOCTEXT_NAMESPACE "DialogueSession"</span>

<span class="n">UDialogueSession</span><span class="o">::</span><span class="n">UDialogueSession</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">NodeType</span> <span class="o">=</span> <span class="n">UDialogueSessionNode</span><span class="o">::</span><span class="n">StaticClass</span><span class="p">();</span>
    <span class="n">EdgeType</span> <span class="o">=</span> <span class="n">UDialogueSessionEdge</span><span class="o">::</span><span class="n">StaticClass</span><span class="p">();</span>

    <span class="n">LeftDialoguerBgColor</span> <span class="o">=</span> <span class="n">FLinearColor</span><span class="o">::</span><span class="n">Black</span><span class="p">;</span>
    <span class="n">RightDialoguerBgColor</span> <span class="o">=</span> <span class="n">FLinearColor</span><span class="p">(</span><span class="mf">0.93f</span><span class="p">,</span> <span class="mf">0.93f</span><span class="p">,</span> <span class="mf">0.93f</span><span class="p">,</span> <span class="mf">1.f</span><span class="p">);</span>

    <span class="n">Name</span> <span class="o">=</span> <span class="s">"DialogueSession"</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#undef LOCTEXT_NAMESPACE</span>
</pre></div>
</div>
<p>We created a class <em>UDialogueSession</em> which inherit from <em>UGenericGraph</em>, this class will be the new asset type.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">DIALOGUESYSTEM_API should changed to {YOURPROJECT}_API.</p>
</div>
</div>
<div class="section" id="step-6">
<h2>Step 6</h2>
<p>We need to create an asset factory which inherit from <em>UFactory</em>, but this class can’t add to your game project directly, because <em>UFactory</em> are in the module <strong>UnrealEd</strong>, this is an editor module,
you can’t pass the Shipping build if your game depends on any editor module.</p>
<p>Solution: creating an editor module for your game project, here is an <a class="reference external" href="https://wiki.unrealengine.com/Creating_an_Editor_Module">tutorial</a>.</p>
<p>After created an editor module, creating “DialogueSessionFactory.h” and “DialogueSessionFactory.cpp” in {YourProject}/Source/{YourProjectEditor}/Private and regenerate solution file.</p>
<p>Your solution should looks like this now:</p>
<img alt="../../../_images/sln_with_editor.png" src="https://jinyuliao.github.io/blog/html/_images/sln_with_editor.png"/>
</div>
<div class="section" id="step-7">
<h2>Step 7</h2>
<p>Edit the {YourProjectEditor}.Build.cs, add dependency module: <em>UnrealEd</em>, <em>GenericGraphRuntime</em>, <em>{YourGameProject}</em> and include path: <em>{YourGameProject}/Public</em></p>
<div class="highlight-c#"><div class="highlight"><pre><span/><span class="n">PublicIncludePaths</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="k">new</span> <span class="kt">string</span><span class="p">[]{</span><span class="s">"DialogueSystem/Public"</span><span class="p">});</span>

<span class="n">PrivateDependencyModuleNames</span><span class="p">.</span><span class="n">AddRange</span><span class="p">(</span><span class="k">new</span> <span class="kt">string</span><span class="p">[]</span> <span class="p">{</span> <span class="s">"UnrealEd"</span><span class="p">,</span> <span class="s">"GenericGraphRuntime"</span><span class="p">,</span> <span class="s">"DialogueSystem"</span> <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="step-8">
<h2>Step 8</h2>
<p>Implement DialogueSessionFactory</p>
<p>DialogueSessionFactory.h</p>
<div class="highlight-c++"><div class="highlight"><pre><span/><span class="cp">#pragma once</span>

<span class="cp">#include</span> <span class="cpf">"CoreMinimal.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"Factories/Factory.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"DialogueSessionFactory.generated.h"</span><span class="cp"/>

<span class="n">UCLASS</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">UDialogueSessionFactory</span> <span class="o">:</span> <span class="k">public</span> <span class="n">UFactory</span>
<span class="p">{</span>
    <span class="n">GENERATED_BODY</span><span class="p">()</span>

<span class="k">public</span><span class="o">:</span>
    <span class="n">UDialogueSessionFactory</span><span class="p">();</span>

    <span class="k">virtual</span> <span class="n">UObject</span><span class="o">*</span> <span class="nf">FactoryCreateNew</span><span class="p">(</span><span class="n">UClass</span><span class="o">*</span> <span class="n">Class</span><span class="p">,</span> <span class="n">UObject</span><span class="o">*</span> <span class="n">InParent</span><span class="p">,</span> <span class="n">FName</span> <span class="n">Name</span><span class="p">,</span> <span class="n">EObjectFlags</span> <span class="n">Flags</span><span class="p">,</span> <span class="n">UObject</span><span class="o">*</span> <span class="n">Context</span><span class="p">,</span> <span class="n">FFeedbackContext</span><span class="o">*</span> <span class="n">Warn</span><span class="p">)</span> <span class="k">override</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="n">FText</span> <span class="nf">GetDisplayName</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span><span class="p">;</span>
    <span class="k">virtual</span> <span class="n">FString</span> <span class="nf">GetDefaultNewAssetName</span><span class="p">()</span> <span class="k">const</span> <span class="k">override</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>DialogueSessionFactory.cpp</p>
<div class="highlight-c++"><div class="highlight"><pre><span/><span class="cp">#include</span> <span class="cpf">"DialogueSessionFactory.h"</span><span class="cp"/>
<span class="cp">#include</span> <span class="cpf">"DialogueSession.h"</span><span class="cp"/>

<span class="cp">#define LOCTEXT_NAMESPACE "DialogueSessionFactory"</span>

<span class="n">UDialogueSessionFactory</span><span class="o">::</span><span class="n">UDialogueSessionFactory</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">bCreateNew</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">bEditAfterNew</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">SupportedClass</span> <span class="o">=</span> <span class="n">UDialogueSession</span><span class="o">::</span><span class="n">StaticClass</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">UObject</span><span class="o">*</span> <span class="n">UDialogueSessionFactory</span><span class="o">::</span><span class="n">FactoryCreateNew</span><span class="p">(</span><span class="n">UClass</span><span class="o">*</span> <span class="n">Class</span><span class="p">,</span> <span class="n">UObject</span><span class="o">*</span> <span class="n">InParent</span><span class="p">,</span> <span class="n">FName</span> <span class="n">Name</span><span class="p">,</span> <span class="n">EObjectFlags</span> <span class="n">Flags</span><span class="p">,</span> <span class="n">UObject</span><span class="o">*</span> <span class="n">Context</span><span class="p">,</span> <span class="n">FFeedbackContext</span><span class="o">*</span> <span class="n">Warn</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">NewObject</span><span class="o">&lt;</span><span class="n">UObject</span><span class="o">&gt;</span><span class="p">(</span><span class="n">InParent</span><span class="p">,</span> <span class="n">Class</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Flags</span> <span class="o">|</span> <span class="n">RF_Transactional</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">FText</span> <span class="n">UDialogueSessionFactory</span><span class="o">::</span><span class="n">GetDisplayName</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">LOCTEXT</span><span class="p">(</span><span class="s">"FactoryName"</span><span class="p">,</span> <span class="s">"Dialogue Session"</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">FString</span> <span class="n">UDialogueSessionFactory</span><span class="o">::</span><span class="n">GetDefaultNewAssetName</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="s">"DialogueSession"</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#undef LOCTEXT_NAMESPACE</span>
</pre></div>
</div>
</div>
<div class="section" id="step-9">
<h2>Step 9</h2>
<p>Compile the solution, open the editor if compile succeeded. right click in your content browser, you can create DialogueSession asset now.</p>
<a class="" data-lightbox="group-12fc4b94-e38a-41ac-8d27-33d4522b1d15" href="https://jinyuliao.github.io/blog/html/_images/dialogue_session_asset1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/dialogue_session_asset1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="done">
<h2>Done</h2>
<p>That’s all in this part, you have created a new asset type <a class="footnote-reference" href="#f1" id="id1">[1]</a> <strong>DialogueSession</strong> and extended GenericGraph’s node and edge type.</p>
<p>In the next part, we will dive into blueprint :)</p>
<p><a class="reference external" href="https://jinyuliao.github.io/blog/html/2018/03/20/ue4_dialogue_system_part3.html">Part3</a></p>
<table class="docutils footnote" frame="void" id="f1" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>a new graph type with GenericGraph editor</td></tr>
</tbody>
</table>
</div>
]]></description>
            <category><![CDATA[ UE4 Dialogue System ]]></category>
             <pubDate>Fri, 15 Dec 2017 00:00:00 +0800</pubDate>
        </item>
    
        <item>
            <link>https://jinyuliao.github.io/blog/html/2017/12/15/ue4_dialogue_system_part1.html</link>
            <guid>https://jinyuliao.github.io/blog/html/2017/12/15/ue4_dialogue_system_part1.html</guid>
            <title><![CDATA[UE4 Dialogue System Part1]]></title>
            <description><![CDATA[<h1>UE4 Dialogue System Part1</h1>
<div class="section" id="introduction">
<h2>Introduction</h2>
<p>This tutorial create a Fire Emblem-like dialogue system in UE4 with my <a class="reference external" href="https://github.com/jinyuliao/GenericGraph">GenericGraph</a> plugin.</p>
<img alt="https://raw.githubusercontent.com/jinyuliao/GenericGraph/master/docs/images/dialogue/dialogue03.png" src="https://raw.githubusercontent.com/jinyuliao/GenericGraph/master/docs/images/dialogue/dialogue03.png"/>
<p>Prerequisite:</p>
<ul class="simple">
<li>UE4 version: 4.18.2 or higher</li>
<li>C++ development enviroment(Visual Studio on Windows or Xcode on Mac)</li>
<li>Some experience with UE4, can make simple UI with UMG</li>
</ul>
<p>In this part, we wiil create a demo project and compile the plugin.</p>
</div>
<div class="section" id="step-1">
<h2>Step 1</h2>
<p>Create a blueprint project with the TopDown template.</p>
<a class="" data-lightbox="group-d970fdb3-bf93-4227-95b2-07a99deb66fc" href="https://jinyuliao.github.io/blog/html/_images/create_project1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/create_project1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="step-2">
<h2>Step 2</h2>
<p>Open your porject’s root folder, create a folder named “<strong>Plugins</strong>”, clone <a class="reference external" href="https://github.com/jinyuliao/GenericGraph">GenericGraph</a> into the “<strong>Plugins</strong>” folder.</p>
<img alt="../../../_images/clone_plugin.png" src="https://jinyuliao.github.io/blog/html/_images/clone_plugin.png"/>
</div>
<div class="section" id="step-3">
<h2>Step 3</h2>
<p>In your editor, click “File-&gt;New C++ Class”.</p>
<img alt="../../../_images/new_cpp.png" src="https://jinyuliao.github.io/blog/html/_images/new_cpp.png"/>
<p>Click “Next”.</p>
<a class="" data-lightbox="group-b2cd4b72-4d9b-442d-bab2-80e7700a2684" href="https://jinyuliao.github.io/blog/html/_images/class_wizard_011.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/class_wizard_011.png" class="" width="100%" height="auto" alt=""/>
                </a><p>Set the class name to “Placeholder”</p>
<a class="" data-lightbox="group-a8c6fd47-3f46-420f-8d63-e64ecc23f101" href="https://jinyuliao.github.io/blog/html/_images/class_wizard_021.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/class_wizard_021.png" class="" width="100%" height="auto" alt=""/>
                </a><p>Click “Create Class”.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Now we have created a c++ class: Placeholder, as the name implies, it’s a placeholder, we don’t need it anymore, we just need a c++ class to generate a c++ project.</p>
</div>
<p>Right click your “YourProject.uproject” file, click “Generate Visual Studio project files”.</p>
<img alt="../../../_images/generate_project.png" src="https://jinyuliao.github.io/blog/html/_images/generate_project.png"/>
<p>Open YourPorject.sln file, you should see the GenericGraph plugin’s files now.</p>
<img alt="../../../_images/sln.png" src="https://jinyuliao.github.io/blog/html/_images/sln.png"/>
<p><strong>Close your project editor</strong>, then compile the c++ solution(F7).</p>
</div>
<div class="section" id="step-4">
<h2>Step 4</h2>
<p>If compile succeeded, open your editor again, right click in your content browser, you can create GenericGraph asset now.</p>
<a class="" data-lightbox="group-cc2a8bd3-28d2-464e-8c7f-ede3d2ff674b" href="https://jinyuliao.github.io/blog/html/_images/generic_graph_asset1.png" title="" data-title=""><img src="https://jinyuliao.github.io/blog/html/_images/generic_graph_asset1.png" class="" width="100%" height="auto" alt=""/>
                </a></div>
<div class="section" id="done">
<h2>Done</h2>
<p>That’s all in this part, you have created a project and compiled the GenericGraph plugin, we will add a “DialogueSession” asset in the next part, then say goodbye to c++ and dive into blueprint.</p>
<p><a class="reference external" href="https://jinyuliao.github.io/blog/html/2017/12/15/ue4_dialogue_system_part2.html">Part2</a></p>
</div>
]]></description>
            <category><![CDATA[ UE4 Dialogue System ]]></category>
             <pubDate>Fri, 15 Dec 2017 00:00:00 +0800</pubDate>
        </item>
    
    </channel>
</rss>